<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="420" viewBox="0 0 1200 420" role="img" aria-label="ChewingGum AD VAE pipeline: train VAE on normal images, reconstruct, compute reconstruction error heatmap, and flag anomalies.">
  <defs>
    <linearGradient id="panel" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0" stop-color="#0f172a"/>
      <stop offset="1" stop-color="#111827"/>
    </linearGradient>
    <linearGradient id="img" x1="0" x2="1" y1="0" y2="1">
      <stop offset="0" stop-color="#e5e7eb"/>
      <stop offset="1" stop-color="#9ca3af"/>
    </linearGradient>
    <linearGradient id="heat" x1="0" x2="1" y1="0" y2="1">
      <stop offset="0" stop-color="#1d4ed8"/>
      <stop offset="0.55" stop-color="#f59e0b"/>
      <stop offset="1" stop-color="#dc2626"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="6" stdDeviation="10" flood-opacity="0.25"/>
    </filter>
    <style>
      .title{font:700 28px ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;fill:#f9fafb}
      .subtitle{font:400 14px ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;fill:#cbd5e1}
      .box{fill:#0b1220;stroke:#334155;stroke-width:2;rx:16;filter:url(#shadow)}
      .label{font:600 16px ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;fill:#e5e7eb}
      .small{font:400 13px ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;fill:#cbd5e1}
      .arrow{stroke:#94a3b8;stroke-width:4;fill:none;marker-end:url(#arrowhead)}
      .chip{fill:#111827;stroke:#334155;stroke-width:1;rx:10}
      .chipText{font:600 12px ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;fill:#e2e8f0}
    </style>
    <marker id="arrowhead" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <path d="M0,0 L12,4 L0,8 Z" fill="#94a3b8"/>
    </marker>
  </defs>

  <rect x="0" y="0" width="1200" height="420" fill="url(#panel)"/>

  <text x="40" y="56" class="title">ChewingGum AD VAE — Final Goal</text>
  <text x="40" y="82" class="subtitle">Learn “normal” appearance, then highlight defects using reconstruction error heatmaps.</text>

  <!-- Train box -->
  <rect x="40" y="120" width="360" height="250" class="box"/>
  <text x="70" y="160" class="label">1) Train (normals only)</text>
  <text x="70" y="186" class="small">Input: images labeled “normal”</text>
  <text x="70" y="210" class="small">Model: VAE (encoder → latent → decoder)</text>
  <text x="70" y="234" class="small">Output: checkpoint with learned normal patterns</text>

  <rect x="70" y="262" width="120" height="88" rx="10" fill="url(#img)" stroke="#64748b" stroke-width="2"/>
  <circle cx="110" cy="306" r="10" fill="#94a3b8"/>
  <circle cx="150" cy="292" r="14" fill="#cbd5e1"/>
  <path d="M78 344 L112 316 L140 336 L168 304 L190 350 L78 350 Z" fill="#d1d5db" opacity="0.85"/>

  <rect x="210" y="262" width="160" height="88" rx="10" fill="#111827" stroke="#64748b" stroke-width="2"/>
  <text x="226" y="292" class="chipText">vae_checkpoint.pt</text>
  <text x="226" y="316" class="small">weights + config</text>

  <!-- Arrow to inference -->
  <path d="M410 245 C470 245, 470 245, 530 245" class="arrow"/>

  <!-- Inference box -->
  <rect x="540" y="120" width="620" height="250" class="box"/>
  <text x="570" y="160" class="label">2) Inference (any surface image)</text>
  <text x="570" y="186" class="small">Reconstruct the image and compute per-pixel error.</text>

  <!-- Input image -->
  <rect x="570" y="215" width="150" height="135" rx="12" fill="url(#img)" stroke="#64748b" stroke-width="2"/>
  <text x="588" y="242" class="chipText">Input</text>
  <path d="M580 338 L610 300 L640 330 L670 290 L712 350 L580 350 Z" fill="#d1d5db" opacity="0.85"/>
  <circle cx="690" cy="304" r="10" fill="#a1a1aa" opacity="0.9"/>

  <!-- Reconstruction -->
  <rect x="760" y="215" width="150" height="135" rx="12" fill="url(#img)" stroke="#64748b" stroke-width="2"/>
  <text x="778" y="242" class="chipText">Reconstruction</text>
  <path d="M770 338 L800 304 L832 328 L862 298 L902 350 L770 350 Z" fill="#d1d5db" opacity="0.82"/>
  <circle cx="880" cy="308" r="7" fill="#a1a1aa" opacity="0.75"/>

  <!-- Heatmap -->
  <rect x="950" y="215" width="150" height="135" rx="12" fill="url(#heat)" stroke="#64748b" stroke-width="2"/>
  <text x="968" y="242" class="chipText">Error Heatmap</text>
  <circle cx="1032" cy="302" r="22" fill="#991b1b" opacity="0.85"/>
  <circle cx="1004" cy="332" r="14" fill="#f59e0b" opacity="0.75"/>
  <circle cx="1068" cy="330" r="10" fill="#1d4ed8" opacity="0.55"/>

  <!-- Small arrows inside inference -->
  <path d="M725 282 L750 282" class="arrow"/>
  <path d="M915 282 L940 282" class="arrow"/>

  <!-- Output chips -->
  <rect x="570" y="120" width="0" height="0" fill="none"/>
  <rect x="570" y="120" width="0" height="0" fill="none"/>
  <rect x="570" y="120" width="0" height="0" fill="none"/>
  <rect x="570" y="120" width="0" height="0" fill="none"/>
  <rect x="570" y="120" width="0" height="0" fill="none"/>
  <rect x="570" y="120" width="0" height="0" fill="none"/>

  <rect x="570" y="330" width="195" height="28" class="chip"/>
  <text x="582" y="349" class="chipText">output-dir/overlays/</text>
  <rect x="775" y="330" width="255" height="28" class="chip"/>
  <text x="787" y="349" class="chipText">output-dir/reconstructions/</text>
  <rect x="1040" y="330" width="120" height="28" class="chip"/>
  <text x="1052" y="349" class="chipText">output-dir/stats.json</text>
</svg>
